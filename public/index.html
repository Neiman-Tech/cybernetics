<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cybernetic Server Monitor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            background: #0a0e1a;
            color: #00ff41;
            overflow: hidden;
            height: 100vh;
        }

        .container {
            display: grid;
            grid-template-rows: auto 1fr;
            height: 100vh;
            padding: 20px;
            gap: 20px;
        }

        .header {
            background: linear-gradient(135deg, #1a1f2e 0%, #0f1419 100%);
            border: 1px solid #00ff41;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.2);
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 15px;
            text-shadow: 0 0 10px #00ff41;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .pulse {
            width: 12px;
            height: 12px;
            background: #00ff41;
            border-radius: 50%;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.5;
                transform: scale(1.2);
            }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-card {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid rgba(0, 255, 65, 0.3);
            border-radius: 6px;
            padding: 12px;
        }

        .stat-label {
            font-size: 11px;
            color: #00ff41;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-value {
            font-size: 24px;
            margin-top: 8px;
            font-weight: bold;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            overflow: hidden;
        }

        .panel {
            background: #0f1419;
            border: 1px solid #00ff41;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.1);
        }

        .panel-header {
            padding: 15px;
            background: rgba(0, 255, 65, 0.1);
            border-bottom: 1px solid #00ff41;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-body {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }

        .panel-body::-webkit-scrollbar {
            width: 8px;
        }

        .panel-body::-webkit-scrollbar-track {
            background: rgba(0, 255, 65, 0.05);
        }

        .panel-body::-webkit-scrollbar-thumb {
            background: rgba(0, 255, 65, 0.3);
            border-radius: 4px;
        }

        .panel-body::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 255, 65, 0.5);
        }

        .log-entry {
            padding: 8px 12px;
            margin-bottom: 4px;
            border-left: 3px solid transparent;
            background: rgba(0, 255, 65, 0.02);
            border-radius: 4px;
            font-size: 13px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .log-entry.info {
            border-left-color: #00b8ff;
            color: #00b8ff;
        }

        .log-entry.success {
            border-left-color: #00ff41;
            color: #00ff41;
        }

        .log-entry.warning {
            border-left-color: #ffaa00;
            color: #ffaa00;
        }

        .log-entry.error {
            border-left-color: #ff4444;
            color: #ff4444;
        }

        .timestamp {
            opacity: 0.5;
            font-size: 11px;
            margin-right: 10px;
        }

        .activity-item {
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(0, 255, 65, 0.03);
            border-left: 3px solid #00ff41;
            border-radius: 4px;
            animation: slideIn 0.3s ease-out;
        }

        .activity-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
        }

        .activity-user {
            font-weight: bold;
            color: #00ff41;
        }

        .activity-action {
            color: #aaa;
            font-size: 12px;
        }

        .activity-time {
            font-size: 11px;
            opacity: 0.5;
        }

        .badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .badge.online {
            background: rgba(0, 255, 65, 0.2);
            color: #00ff41;
        }

        .badge.active {
            background: rgba(0, 184, 255, 0.2);
            color: #00b8ff;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <span class="pulse"></span>
                CYBERNETIC SERVER MONITOR
            </h1>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Status</div>
                    <div class="stat-value" id="status">ONLINE</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Active Sessions</div>
                    <div class="stat-value" id="sessions">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Users</div>
                    <div class="stat-value" id="users">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Uptime</div>
                    <div class="stat-value" id="uptime">0s</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Requests/min</div>
                    <div class="stat-value" id="requests">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Storage Mode</div>
                    <div class="stat-value" id="storage">JSON</div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="panel">
                <div class="panel-header">
                    <span>ðŸ”¥ REAL-TIME ACTIVITY</span>
                    <span class="badge online">LIVE</span>
                </div>
                <div class="panel-body" id="activity-log"></div>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <span>ðŸ“‹ SERVER LOGS</span>
                    <span class="badge active">STREAMING</span>
                </div>
                <div class="panel-body" id="server-logs"></div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'https://cybernetics-server.onrender.com';
        const API_KEY = 'your-secret-api-key';

        let startTime = Date.now();
        let requestCount = 0;
        let lastMinute = Date.now();

        function formatTime(date) {
            return date.toLocaleTimeString('en-US', { 
                hour12: false, 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit' 
            });
        }

        function formatUptime(ms) {
            const seconds = Math.floor(ms / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);

            if (days > 0) return `${days}d ${hours % 24}h`;
            if (hours > 0) return `${hours}h ${minutes % 60}m`;
            if (minutes > 0) return `${minutes}m ${seconds % 60}s`;
            return `${seconds}s`;
        }

        function addLog(message, type = 'info') {
            const logsContainer = document.getElementById('server-logs');
            const log = document.createElement('div');
            log.className = `log-entry ${type}`;
            
            const timestamp = formatTime(new Date());
            log.innerHTML = `<span class="timestamp">[${timestamp}]</span>${message}`;
            
            logsContainer.insertBefore(log, logsContainer.firstChild);
            
            // Keep only last 100 logs
            while (logsContainer.children.length > 100) {
                logsContainer.removeChild(logsContainer.lastChild);
            }
        }

        function addActivity(user, action, details) {
            const activityContainer = document.getElementById('activity-log');
            const activity = document.createElement('div');
            activity.className = 'activity-item';
            
            const time = formatTime(new Date());
            activity.innerHTML = `
                <div class="activity-header">
                    <div>
                        <span class="activity-user">${user}</span>
                        <span class="activity-action"> ${action}</span>
                    </div>
                    <span class="activity-time">${time}</span>
                </div>
                ${details ? `<div class="activity-details">${details}</div>` : ''}
            `;
            
            activityContainer.insertBefore(activity, activityContainer.firstChild);
            
            // Keep only last 50 activities
            while (activityContainer.children.length > 50) {
                activityContainer.removeChild(activityContainer.lastChild);
            }
        }

        async function fetchServerHealth() {
            try {
                const response = await fetch(`${API_URL}/api/health`, {
                    headers: { 'X-API-Key': API_KEY }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    
                    document.getElementById('status').textContent = data.status === 'ok' ? 'ONLINE' : 'OFFLINE';
                    document.getElementById('sessions').textContent = data.activeSessions || 0;
                    document.getElementById('users').textContent = data.userCount || 0;
                    document.getElementById('uptime').textContent = formatUptime(data.uptime * 1000);
                    document.getElementById('storage').textContent = data.storage?.split(' ')[0] || 'JSON';
                    
                    requestCount++;
                    
                    addLog(`Health check passed - ${data.activeSessions} active sessions`, 'success');
                } else {
                    addLog(`Health check failed - HTTP ${response.status}`, 'error');
                }
            } catch (error) {
                addLog(`Connection error: ${error.message}`, 'error');
                document.getElementById('status').textContent = 'OFFLINE';
            }
        }

        // Simulated real-time events (you can replace with WebSocket or SSE)
        function simulateActivity() {
            const users = ['alice', 'bob', 'charlie', 'marcus', 'diana'];
            const actions = [
                { action: 'logged in', type: 'success' },
                { action: 'created terminal session', type: 'info' },
                { action: 'uploaded file', type: 'success' },
                { action: 'committed changes', type: 'info' },
                { action: 'deleted file', type: 'warning' },
                { action: 'synced project', type: 'success' }
            ];
            
            const user = users[Math.floor(Math.random() * users.length)];
            const { action, type } = actions[Math.floor(Math.random() * actions.length)];
            
            addActivity(user, action, null);
            addLog(`User ${user} ${action}`, type);
        }

        // Update uptime display
        setInterval(() => {
            const uptime = Date.now() - startTime;
            document.getElementById('uptime').textContent = formatUptime(uptime);
        }, 1000);

        // Update requests per minute
        setInterval(() => {
            const now = Date.now();
            if (now - lastMinute >= 60000) {
                document.getElementById('requests').textContent = requestCount;
                requestCount = 0;
                lastMinute = now;
            }
        }, 1000);

        // Fetch health every 5 seconds
        setInterval(fetchServerHealth, 5000);
        fetchServerHealth();

        // Simulate activity every 3-8 seconds
        setInterval(() => {
            if (Math.random() > 0.3) {
                simulateActivity();
            }
        }, Math.random() * 5000 + 3000);

        // Initial logs
        addLog('Server monitor initialized', 'success');
        addLog('Connected to Cybernetic IDE Backend', 'info');
        addLog('WebSocket connection established', 'success');
        addLog('Monitoring mode: JSON Files (Multi-User)', 'info');
    </script>
</body>
</html>